{% extends 'contributions/base.html' %}

{% block title %}Dashboard - easy-m{% endblock %}

{% block content %}
<div class="container mx-auto">
    <!-- Welcome Section -->
    <div class="mb-8">
        <h1 class="text-4xl font-bold text-charcoal">Welcome, {{ user.username }}</h1>
        <p class="text-lg text-gray-600 mt-2">Manage your group funds with ease. Check out your groups or join new ones!</p>
    </div>

    <!-- Action Buttons -->
    <div class="flex space-x-4 mb-8">
        <a href="{% url 'create_group' %}" class="bg-teal-600 text-white px-6 py-3 rounded-full hover:bg-teal-700 transition">Create Group</a>
        <a href="{% url 'join_group' %}" class="border border-teal-600 text-teal-600 px-6 py-3 rounded-full hover:bg-teal-600 hover:text-white transition">Join Group</a>
    </div>

    <!-- Groups Section -->
    <h2 class="text-2xl font-semibold text-charcoal mb-4">Your Groups</h2>
    {% if groups %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for group in groups %}
        <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition">
            <h3 class="text-xl font-semibold text-charcoal">
                <a href="{% url 'group_detail' group.id %}" class="hover:text-teal-600">{{ group.name }}</a>
                {% if group.admin == user %}
                <span class="text-sm text-coral ml-2">(Admin)</span>
                {% endif %}
            </h3>
            <p class="text-gray-600 mt-2">Total Balance: KES {{ group.contribution_set.all|length|default:"0" }}</p>
            {% for payout in next_payouts %}
                {% if payout.group == group %}
                <p class="text-gray-600 mt-1">Next Payout: {{ payout.recipient }} on {{ payout.payout_date }}</p>
                {% endif %}
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-gray-600">You are not part of any groups yet.</p>
    {% endif %}
</div>
{% endblock %}